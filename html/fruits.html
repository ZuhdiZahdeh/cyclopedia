<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ุงูููุงูู - ููุณูุนุฉ ุงูุฃุทูุงู</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <header>
    <h1>๐ ููุณูุนุฉ ุงูููุงูู</h1>
    <button onclick="location.href='index.html'">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
  </header>

  <main class="main-content">
    <p>ุฌุงุฑู ุชุญููู ูุญุชูู ุงูููุงูู...</p>
  </main>

  <aside>
    <div id="fruits-sidebar-controls" class="sidebar-controls">
      <select id="game-lang-select-fruits"></select>
      <select id="voice-select-fruits"></select>
      <button id="play-sound-btn-fruits">๐ ุงุณุชูุน</button>
      <button id="prev-fruits-btn">โฎ ุงูุณุงุจู</button>
      <button id="next-fruits-btn">โญ ุงูุชุงูู</button>
    </div>
    <button id="toggle-description-btn">๐ ุนุฑุถ/ุฅุฎูุงุก ุงููุตู</button>
    <button id="toggle-details-btn">โน๏ธ ุนุฑุถ/ุฅุฎูุงุก ุงูุชูุงุตูู</button>
  </aside>

  <script type="module">
    import {
      loadSubjectGameContent,
      showNextItem,
      showPreviousItem,
      playCurrentItemAudio
    } from '/src/js/subject-game.js';

    import { loadLanguage, applyTranslations, setDirection, currentLang } from '/src/js/lang-handler.js';

    async function initializeSubjectControls(subjectType) {
      const langSelect = document.getElementById(`game-lang-select-${subjectType}`);
      const voiceSelect = document.getElementById(`voice-select-${subjectType}`);
      const playSoundBtn = document.getElementById(`play-sound-btn-${subjectType}`);
      const prevBtn = document.getElementById(`prev-${subjectType}-btn`);
      const nextBtn = document.getElementById(`next-${subjectType}-btn`);

      if (!langSelect || !voiceSelect) return;

      if (langSelect.options.length === 0) {
        ['ar', 'en', 'he'].forEach(langCode => {
          const option = document.createElement('option');
          option.value = langCode;
          option.textContent = { 'ar': 'ุงูุนุฑุจูุฉ', 'en': 'English', 'he': 'ืขืืจืืช' }[langCode];
          langSelect.appendChild(option);
        });
        langSelect.value = currentLang;
      }

      if (voiceSelect.options.length === 0) {
        ['teacher', 'boy', 'girl', 'child'].forEach(voiceType => {
          const option = document.createElement('option');
          option.value = voiceType;
          option.textContent = { 'teacher': 'ุงููุนูู', 'boy': 'ุตูุช ููุฏ', 'girl': 'ุตูุช ุจูุช', 'child': 'ุตูุช ุทูู' }[voiceType];
          voiceSelect.appendChild(option);
        });
        voiceSelect.value = 'teacher';
      }

      langSelect.onchange = async () => {
        const newLang = langSelect.value;
        await loadLanguage(newLang);
        applyTranslations();
        setDirection(newLang);
        await loadSubjectGameContent(subjectType);
      };

      if (playSoundBtn) playSoundBtn.onclick = () => playCurrentItemAudio(subjectType);
      if (prevBtn) prevBtn.onclick = () => showPreviousItem(subjectType);
      if (nextBtn) nextBtn.onclick = () => showNextItem(subjectType);

      applyTranslations();
    }

    document.addEventListener('DOMContentLoaded', async () => {
      await loadSubjectGameContent('fruits');
      await initializeSubjectControls('fruits');
    });
  </script>
</body>
</html>
